JumboItem=Backbone.Model.extend({}),window.JumboView=Backbone.View.extend({template:_.template($("#px_project_item_template").html()),el:"#project-jumbo",initialize:function(){_.bindAll(this,"render"),this.model.on("change",this.render,this),this.render()},events:{},render:function(){return $(this.el).html(this.template({item:this.model})),this}}),ProjectItem=Backbone.Model.extend({getCoverBg:function(a){return this.getCoverImg()!=""?"background-image: url('"+this.getCoverImg(a)+"')":""},getCoverBgClass:function(){return this.getCoverImg()==""?"background-gradient-"+Math.floor(this.get("filename").length%33+1):""},getCoverImg:function(a){if(this.get("cover_img_url")){if(a>6){if(this.get("cover_img_url_800"))return this.get("cover_img_url_800")}else if(this.get("cover_img_url_400"))return this.get("cover_img_url_400");return this.get("cover_img_url")}return this.get("snapshots")&&this.get("snapshots").length>0?this.get("snapshots")[0].image_url_large:""}}),ProjectList=Backbone.Collection.extend({model:ProjectItem}),window.ProjectItemView=Backbone.View.extend({template:_.template($("#px_project_item_template").html()),tagName:"div",className:"col-xs-6 col-sm-6",initialize:function(){_.bindAll(this,"render"),this.model.on("change",this.render,this)},events:{},render:function(){var a=4;return window.projects_list.length==1?a=12:window.projects_list.length==2||window.projects_list.length==4?a=6:window.projects_list.length==3?a=4:window.projects_list.indexOf(this.model)==0?a=8:!window.user_signed_in&&window.app_item.get("category")=="featured"&&(window.projects_list.length+1)%3==1&&window.projects_list.indexOf(this.model)==window.projects_list.length-4?a=12:!window.user_signed_in&&window.app_item.get("category")=="featured"&&(window.projects_list.length+1)%3==2&&window.projects_list.indexOf(this.model)==window.projects_list.length-4?a=8:window.user_signed_in&&window.app_item.get("category")=="featured"&&(window.projects_list.length+1)%3==1&&window.projects_list.indexOf(this.model)==window.projects_list.length-1?a=12:window.user_signed_in&&window.app_item.get("category")=="featured"&&(window.projects_list.length+1)%3==2&&window.projects_list.indexOf(this.model)==window.projects_list.length-1?a=8:a=4,$(this.el).addClass("col-md-"+a),$(this.el).html(this.template({item:this.model,size:a})),this}}),window.ProjectListView=Backbone.View.extend({el:"#projects-ul",initialize:function(){_.bindAll(this,"renderProjectItem","render"),this.collection.bind("add",this.renderFileItem),this.collection.bind("reset",this.render,this)},events:{},render:function(){return $(this.el).html(""),this.collection.each(this.renderProjectItem),this},renderProjectItem:function(a){var b=new ProjectItemView({model:a});!window.user_signed_in&&window.app_item.get("category")=="featured"&&this.collection.indexOf(a)>=this.collection.length-3?$("#signup-projects-ul").append(b.render().el):$(this.el).append(b.render().el)}}),AppItem=Backbone.Model.extend({url:function(){return"/api/open/"+this.category+"/"+this.page+".json"},page:1,category:"recent"}),window.AppView=Backbone.View.extend({el:$("body"),model:AppItem,initialize:function(){_.bindAll(this,"render"),this.model.bind("change",this.render,this),this.render()},events:{},render:function(){window.projects_list.reset(this.model.get("projects")),this.model.get("next_page_url")&&this.model.get("next_page_url")!=""||this.model.get("previous_page_url")&&this.model.get("previous_page_url")!=""?$(".pagination-container").show():$(".pagination-container").hide(),this.model.get("next_page_url")&&this.model.get("next_page_url")!=""?$(".page-next-btn").attr("href",this.model.get("next_page_url")):$(".page-next-btn").hide(),this.model.get("previous_page_url")&&this.model.get("previous_page_url")!=""?$(".page-prev-btn").attr("href",this.model.get("previous_page_url")):$(".page-prev-btn").hide(),this.model.get("projects_count")&&$(".content_projects_count").html(this.model.get("projects_count")),this.model.get("files_count")&&$(".content_files_count").html(this.model.get("files_count")),!window.user_signed_in&&this.model.get("page")&&parseInt(this.model.get("page"))>=2&&$(".page-next-btn").hide()}}),window.projects_list=new ProjectList,window.projects_list_view=new ProjectListView({collection:projects_list}),window.app_item=new AppItem(window.init_projects_json),window.app_view=new AppView({model:window.app_item}),$(".px-grid-item-preview").on("mousemove",function(a){var b=$(this).find(".px-grid-item-preview-default img").length;if(b>1){var c=$(this).width(),d=c/b,e=$(this).parent().offset(),f=a.pageX-e.left,g=a.pageY-e.top,h=Math.floor(f/d)+1;$(this).find(".px-grid-item-preview-default img").hide(),$(this).find(".px-grid-item-preview-default img:nth-child("+h+")").css("display","inline-block")}}).on("mouseout",function(a){$(this).find(".px-grid-item-preview-default img").hide(),$(this).find(".px-grid-item-preview-default img:nth-child(1)").css("display","inline-block")}),$(".admin-update-btn").on("click",function(a){return item_id=$(a.currentTarget).attr("data-id"),featured=$("#project-"+item_id).find("form input[name=featured]").is(":checked"),featured_notes=$("#project-"+item_id).find("form .featured_notes").val(),notes=$("#project-"+item_id).find("form .notes").val(),tags=$("#project-"+item_id).find("form .tags").val(),log(tags),$.post("/gallery/admin_update",{id:item_id,featured:featured,featured_notes:featured_notes,notes:notes,tags:tags},function(a){}).success(function(){$("#project-"+item_id).find(".admin-update-btn").html("saved!")}).error(function(){$("#project-"+item_id).find(".admin-update-btn").html("error!")}).complete(function(){}),a.preventDefault(),!1})